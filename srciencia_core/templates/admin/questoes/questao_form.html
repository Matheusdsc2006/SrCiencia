{% extends "admin/base-admin.html" %}
{% load static %}

{% block content %}
<main>
    
    <h2>{% if questao_form.instance.pk %}Editar Questão{% else %}Nova Questão{% endif %}</h2>
    <form method="post" enctype="multipart/form-data">  <!-- Adiciona enctype para upload de arquivos -->
      {% csrf_token %}
      {{ questao_form.as_p }}
      <h3>Alternativas</h3>
      {{ formset.management_form }}
      <div>
        {% for form in formset %}
          {{ form.as_p }}
        {% endfor %}
      </div>
      <button type="submit" class="btn btn-primary">Salvar</button>
      <a href="{% url 'questao_list' %}" class="btn btn-secondary">Cancelar</a>
    </form>
  
    {% if questao_form.instance.pk %}
      <h3>Visualização da Questão:</h3>
      <div>
        <h4>Descrição:</h4>
        <div id="latex-preview-descricao">{{ questao_form.instance.descricao|safe }}</div>
        
        <h4>Resolução:</h4>
        <div id="latex-preview-resolucao">{{ questao_form.instance.resolucao|safe }}</div>
        
        <h4>Alternativas:</h4>
        <ul>
          {% for form in formset %}
            <li>{{ form.instance.descricao|safe }}</li>
          {% endfor %}
        </ul>
      </div>
      <script>
        MathJax.typeset();  // Renderiza o LaTeX após a atualização do DOM
      </script>
    {% endif %}
</main>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/questao-form.js' %}"></script>
{% endblock %}
